<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <title>Login Google OAuth</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <link rel="stylesheet" href="styles.css">
    <script>
        const CLIENT_ID = '440684762959-1for0aulaia3dl2losusca0vjhnsei95.apps.googleusercontent.com';

        function handleCredentialResponse(response) {
            // Stocker le token dans sessionStorage
            sessionStorage.setItem('google_jwt', response.credential);
            // Rediriger vers logged.html
            window.location.href = 'logged.html';
        }

        window.onload = () => {
            // Si token déjà présent, on redirige directement
            if (sessionStorage.getItem('google_jwt')) {
                window.location.href = 'logged.html';
                return;
            }

            // Sinon, on initialise le bouton Google
            google.accounts.id.initialize({
                client_id: CLIENT_ID,
                callback: handleCredentialResponse,
                auto_select: false,
                cancel_on_tap_outside: false
            });
            google.accounts.id.renderButton(
                document.getElementById('g_id_signin'),
                { theme: 'outline', size: 'large', width: 300 }
            );
            google.accounts.id.prompt(); // Affiche le prompt automatiquement (optionnel)
        };
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 2em;
            background-color: #0a1e3a;
            color: #e0e6f0;
        }
    </style>
</head>

<body>
    <h1>Login Google OAuth</h1>
    <div id="g_id_signin"></div>
</body>

</html>